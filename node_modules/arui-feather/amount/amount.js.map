{"version":3,"sources":["amount/amount.jsx"],"names":["AMOUNT_MAJOR_MINOR_PARTS_SEPARATOR","AMOUNT_MAJOR_PART_SIZE","ZERO_MINOR_PART_REGEXP","MINUS_SIGN_HTML_CODE","createSplitter","partSize","parts","str","length","from","to","slice","concat","formatAmount","amount","value","currency","minority","code","fractionDigits","Math","log","LN10","isNegative","valueAbs","abs","valueAbsStr","toFixed","numberParts","split","majorPart","minorPart","amountSplitter","majorPartFormatted","reverse","join","formattedValueStr","currencySymbol","Amount","render","cn","props","size","amountInner","renderSeparatorAndMinorPart","renderCurrencySymbol","id","isHeading","showZeroMinorPart","needMinorPart","test","Component","propTypes","shape","number","string","isRequired","bool","oneOf","theme","className","defaultProps"],"mappings":"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","file":"amount.js","sourcesContent":["/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport Type from 'prop-types';\n\nimport Heading from '../heading/heading';\nimport Label from '../label/label';\n\nimport cn from '../cn';\nimport { getCurrencySymbol } from '../lib/currency-codes';\nimport performance from '../performance';\n\nconst AMOUNT_MAJOR_MINOR_PARTS_SEPARATOR = ',';\nconst AMOUNT_MAJOR_PART_SIZE = 3;\nconst ZERO_MINOR_PART_REGEXP = /^0+$/;\nconst MINUS_SIGN_HTML_CODE = '\\u2212';\n\nfunction createSplitter(partSize) {\n    let parts = function (str) {\n        let { length } = str;\n\n        if (length <= partSize) {\n            return [str];\n        }\n\n        let from = length - partSize;\n        let to = length;\n\n        return [str.slice(from, to)].concat(parts(str.slice(0, from)));\n    };\n    return parts;\n}\n\nfunction formatAmount(amount) {\n    let {\n        value,\n        currency: {\n            minority,\n            code\n        }\n    } = amount;\n    let fractionDigits = Math.log(minority) / Math.LN10;\n\n    let isNegative = value < 0;\n\n    let valueAbs = Math.abs(value);\n\n    let valueAbsStr = (valueAbs / minority).toFixed(fractionDigits);\n\n    let numberParts = valueAbsStr.split('.');\n    let majorPart = numberParts[0];\n    let minorPart = numberParts[1];\n\n    let amountSplitter = createSplitter(AMOUNT_MAJOR_PART_SIZE);\n\n    let majorPartFormatted = amountSplitter(majorPart).reverse().join(' ');\n    let formattedValueStr = majorPartFormatted + (minorPart ? `,${minorPart}` : '');\n\n    return {\n        majorPart: majorPartFormatted,\n        minorPart,\n        value: formattedValueStr,\n        isNegative,\n        currencySymbol: getCurrencySymbol(code)\n    };\n}\n\n/**\n * Компонент для отображения суммы.\n */\n@cn('amount')\n@performance(true)\nclass Amount extends React.Component {\n    static propTypes = {\n        amount: Type.shape({\n            /** Абсолютное значение суммы */\n            value: Type.number,\n            /** Валюта */\n            currency: Type.shape({\n                /** Международный код валюты */\n                code: Type.string,\n                /** Количество минорных единиц валюты */\n                minority: Type.number\n            })\n        }).isRequired,\n        /** Отображение минорной части, если она нулевая */\n        showZeroMinorPart: Type.bool,\n        /** Размер компонента */\n        size: Type.oneOf(['s', 'm', 'l', 'xl']),\n        /** Использовать компонент `Heading` для вывода числа */\n        isHeading: Type.bool,\n        /** Тема компонента */\n        theme: Type.oneOf(['alfa-on-color', 'alfa-on-white']),\n        /** Дополнительный класс */\n        className: Type.string,\n        /** Идентификатор компонента в DOM */\n        id: Type.string\n    };\n\n    static defaultProps = {\n        size: 'm',\n        showZeroMinorPart: true,\n        isHeading: false\n    };\n\n    render(cn) {\n        let { amount, size } = this.props;\n        let {\n            majorPart,\n            minorPart,\n            isNegative,\n            currencySymbol\n        } = formatAmount(amount);\n\n        let amountInner = (\n            <span>\n                <span className={ cn('major') }>\n                    { isNegative && MINUS_SIGN_HTML_CODE }\n                    { majorPart }\n                </span>\n                { this.renderSeparatorAndMinorPart(cn, minorPart) }\n                { this.renderCurrencySymbol(cn, currencySymbol) }\n            </span>\n        );\n\n        return (\n            <div className={ cn() } id={ this.props.id }>\n                {\n                    this.props.isHeading\n                        ? (\n                            <Heading size={ size }>\n                                { amountInner }\n                            </Heading>\n                        ) : (\n                            <Label size={ size }>\n                                { amountInner }\n                            </Label>\n                        )\n                }\n            </div>\n        );\n    }\n\n    renderSeparatorAndMinorPart(cn, minorPart) {\n        let { showZeroMinorPart } = this.props;\n\n        let needMinorPart = false;\n\n        if (minorPart) {\n            needMinorPart = true;\n\n            if (!showZeroMinorPart && ZERO_MINOR_PART_REGEXP.test(minorPart)) {\n                needMinorPart = false;\n            }\n        }\n\n        if (needMinorPart) {\n            return (\n                <div className={ cn('minor-container') }>\n                    <span className={ cn('separator') } >{ AMOUNT_MAJOR_MINOR_PARTS_SEPARATOR }</span>\n                    <span className={ cn('minor') } >{ minorPart }</span>\n                </div>\n            );\n        }\n        return null;\n    }\n\n    renderCurrencySymbol(cn, currencySymbol) {\n        return (\n            <span className={ cn('currency') } >\n                { ` ${currencySymbol}` }\n            </span>\n        );\n    }\n}\n\nexport default Amount;\n"]}