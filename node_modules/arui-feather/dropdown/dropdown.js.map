{"version":3,"sources":["dropdown/dropdown.jsx"],"names":["Dropdown","state","opened","switcherHovered","popupHovered","componentDidMount","popup","setTarget","switcher","getNode","render","cn","props","id","renderSwitcher","renderPopup","content","children","switcherText","undefined","switcherType","renderSwitcherButton","renderSwitcherLink","size","disabled","togglable","handleSwitcherClick","handleSwitcherMouseEnter","handleSwitcherMouseLeave","mainOffset","popupProps","type","className","mode","handlePopupMouseEnter","handlePopupMouseLeave","handlePopupClickOutside","popupContent","newOpenedStatusValue","setState","onSwitcherClick","onSwitcherMouseEnter","onSwitcherMouseLeave","onPopupMouseEnter","onPopupMouseLeave","onPopupClickOutside","Component","propTypes","oneOf","node","shape","string","height","directions","arrayOf","target","number","secondaryOffset","fitContaiterOffset","invalid","bool","visible","padded","theme","onMouseEnter","func","onMouseLeave","onClickOutside","minWidth","maxWidth","oneOfType","defaultProps"],"mappings":"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","file":"dropdown.js","sourcesContent":["/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\nimport { autobind } from 'core-decorators';\nimport React from 'react';\nimport Type from 'prop-types';\n\nimport Button from '../button/button';\nimport Link from '../link/link';\nimport Popup from '../popup/popup';\n\nimport cn from '../cn';\nimport performance from '../performance';\nimport { POPUP_MAIN_OFFSET } from '../vars';\n\n/**\n * Компонент «выпадашка»: ссылка или кнопка. По клику показывается Popup.\n */\n@cn('dropdown')\n@performance()\nclass Dropdown extends React.Component {\n    static propTypes = {\n        /** Тип компонента */\n        switcherType: Type.oneOf(['link', 'button']),\n        /** Текст кнопки компонента */\n        switcherText: Type.node,\n        /** Компонент [Popup](../popup/) */\n        popupContent: Type.node,\n        /** Свойства для компонента [Popup](../popup/) */\n        popupProps: Type.shape({\n            className: Type.string,\n            type: Type.oneOf(['default', 'tooltip']),\n            height: Type.oneOf(['default', 'available', 'adaptive']),\n            directions: Type.arrayOf(Type.oneOf([\n                'anchor', 'top-left', 'top-center', 'top-right', 'left-top', 'left-center', 'left-bottom', 'right-top',\n                'right-center', 'right-bottom', 'bottom-left', 'bottom-center', 'bottom-right'\n            ])),\n            target: Type.oneOf(['anchor', 'position', 'screen']),\n            mainOffset: Type.number,\n            secondaryOffset: Type.number,\n            fitContaiterOffset: Type.number,\n            invalid: Type.bool,\n            visible: Type.bool,\n            padded: Type.bool,\n            size: Type.oneOf(['s', 'm', 'l', 'xl']),\n            theme: Type.oneOf(['alfa-on-color', 'alfa-on-white']),\n            onMouseEnter: Type.func,\n            onMouseLeave: Type.func,\n            onClickOutside: Type.func,\n            minWidth: Type.number,\n            maxWidth: Type.number\n        }),\n        /** Управление возможностью отображать попап при наведении курсора */\n        mode: Type.oneOf(['hover', 'normal']),\n        /** Управление возможностью открытия попапа */\n        disabled: Type.bool,\n        /** Управление состоянием открыт/закрыт попапа */\n        opened: Type.bool,\n        /** Только для switcherType='button'. Тип переключателя для кнопки, 'check' */\n        togglable: Type.oneOf(['button', 'check']),\n        /** Размер компонента */\n        size: Type.oneOf(['s', 'm', 'l', 'xl']),\n        /** Дочерние элементы `Dropdown` */\n        children: Type.oneOfType([Type.arrayOf(Type.node), Type.node]),\n        /** Тема компонента */\n        theme: Type.oneOf(['alfa-on-color', 'alfa-on-white']),\n        /** Дополнительный класс */\n        className: Type.string,\n        /** Идентификатор компонента в DOM */\n        id: Type.string,\n        /** Обработчик клика по кнопке компонента */\n        onSwitcherClick: Type.func,\n        /** Обработчик события наведения курсора на кнопку компонента */\n        onSwitcherMouseEnter: Type.func,\n        /** Обработчик события снятия курсора с кнопки компонента */\n        onSwitcherMouseLeave: Type.func,\n        /** Обработчик события наведения курсора на попап */\n        onPopupMouseEnter: Type.func,\n        /** Обработчик события снятия курсора с попапа */\n        onPopupMouseLeave: Type.func,\n        /** Обработчик события клика попапа за пределами попапа */\n        onPopupClickOutside: Type.func\n    };\n\n    static defaultProps = {\n        switcherType: 'link',\n        switcherText: 'Switcher',\n        disabled: false,\n        popupProps: {\n            target: 'anchor'\n        },\n        size: 'm'\n    };\n\n    state = {\n        opened: false,\n        switcherHovered: false,\n        popupHovered: false\n    };\n\n    popup;\n    switcher;\n\n    componentDidMount() {\n        this.popup.setTarget(this.switcher.getNode());\n    }\n\n    render(cn) {\n        return (\n            <div className={ cn() } id={ this.props.id }>\n                { this.renderSwitcher(cn) }\n                { this.renderPopup(cn) }\n            </div>\n        );\n    }\n\n    renderSwitcher(cn) {\n        let content = this.props.children || this.props.switcherText;\n        let opened = this.props.opened !== undefined\n            ? this.props.opened\n            : this.state.opened;\n\n        return this.props.switcherType === 'button'\n            ? this.renderSwitcherButton(cn, content, opened)\n            : this.renderSwitcherLink(cn, content);\n    }\n\n    renderSwitcherButton(cn, content, opened) {\n        return (\n            <Button\n                className={ cn('switcher') }\n                size={ this.props.size }\n                ref={ (switcher) => { this.switcher = switcher; } }\n                disabled={ this.props.disabled }\n                togglable={ this.props.togglable }\n                checked={ this.props.togglable === 'check' && opened }\n                onClick={ !this.props.disabled ? this.handleSwitcherClick : undefined }\n                onMouseEnter={ this.handleSwitcherMouseEnter }\n                onMouseLeave={ this.handleSwitcherMouseLeave }\n            >\n                { content }\n            </Button>\n        );\n    }\n\n    renderSwitcherLink(cn, content) {\n        return (\n            <Link\n                className={ cn('switcher') }\n                size={ this.props.size }\n                ref={ (switcher) => { this.switcher = switcher; } }\n                disabled={ this.props.disabled }\n                pseudo={ true }\n                text={ content }\n                onClick={ !this.props.disabled ? this.handleSwitcherClick : undefined }\n                onMouseEnter={ this.handleSwitcherMouseEnter }\n                onMouseLeave={ this.handleSwitcherMouseLeave }\n            />\n        );\n    }\n\n    renderPopup(cn) {\n        let mainOffset;\n        let opened = this.props.opened !== undefined\n            ? this.props.opened\n            : this.state.opened;\n\n        if (this.props.popupProps === undefined || (\n            this.props.popupProps && this.props.popupProps.type !== 'tooltip')) {\n            switch (this.props.size) {\n                case 's':\n                case 'm': mainOffset = POPUP_MAIN_OFFSET / 2; break;\n                case 'l':\n                case 'xl': mainOffset = POPUP_MAIN_OFFSET; break;\n            }\n        }\n\n        let popupProps = {\n            className: cn('popup'),\n            size: this.props.size,\n            mainOffset,\n            ...this.props.popupProps\n        };\n\n        return (\n            <Popup\n                { ...popupProps }\n                ref={ (popup) => { this.popup = popup; } }\n                visible={\n                    (!this.props.disabled && opened) ||\n                    (this.props.mode === 'hover' && (this.state.switcherHovered || this.state.popupHovered))\n                }\n                onMouseEnter={ this.handlePopupMouseEnter }\n                onMouseLeave={ this.handlePopupMouseLeave }\n                onClickOutside={ this.handlePopupClickOutside }\n            >\n                { this.props.popupContent }\n            </Popup>\n        );\n    }\n\n    @autobind\n    handleSwitcherClick() {\n        let newOpenedStatusValue = this.props.opened !== undefined\n            ? !this.props.opened\n            : !this.state.opened;\n\n        this.setState({\n            opened: newOpenedStatusValue\n        });\n\n        if (this.props.onSwitcherClick) {\n            this.props.onSwitcherClick(newOpenedStatusValue);\n        }\n    }\n\n    @autobind\n    handleSwitcherMouseEnter() {\n        this.setState({ switcherHovered: true });\n\n        if (this.props.onSwitcherMouseEnter) {\n            this.props.onSwitcherMouseEnter();\n        }\n    }\n\n    @autobind\n    handleSwitcherMouseLeave() {\n        this.setState({ switcherHovered: false });\n\n        if (this.props.onSwitcherMouseLeave) {\n            this.props.onSwitcherMouseLeave();\n        }\n    }\n\n    @autobind\n    handlePopupMouseEnter() {\n        this.setState({ popupHovered: true });\n\n        if (this.props.onPopupMouseEnter) {\n            this.props.onPopupMouseEnter();\n        }\n    }\n\n    @autobind\n    handlePopupMouseLeave() {\n        this.setState({ popupHovered: false });\n\n        if (this.props.onPopupMouseLeave) {\n            this.props.onPopupMouseLeave();\n        }\n    }\n\n    @autobind\n    handlePopupClickOutside() {\n        this.setState({ opened: false });\n\n        if (this.props.onPopupClickOutside) {\n            this.props.onPopupClickOutside();\n        }\n    }\n}\n\nexport default Dropdown;\n"]}